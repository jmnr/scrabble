<!DOCTYPE html>
<head>
  <link rel="stylesheet" href="https://code.jquery.com/qunit/qunit-1.18.0.css">
</head>
<body>

<p id="response"></p>

<script>

function ajaxGetRequest (searchurl, callback){
  var request = new XMLHttpRequest();
  request.onreadystatechange = function() {
      if(request.readyState === 4) {
        callback(request.responseText);
      };
  };
  request.open("GET", searchurl, true);
  request.send();
}

function makeUrl (word) {
  return ('http://api.wordnik.com/v4/word.json/' + word +
  "/definitions?limit=1&includeRelated=false&useCanonical=true&includeTags=false&api_key=a2a73e7b926c924fad7001ca3111acd55af2ffabf50eb4ae5");
}

function displayResults (response) {
  var definition = JSON.parse(response)[0].text;
  document.getElementById("response").innerHTML = definition;
  console.log(definition);
  return definition;
}

ajaxGetRequest(makeUrl("sky"), displayResults);

</script>

<div id="qunit"></div>
<div id="qunit-fixture"></div>
<script src="https://code.jquery.com/qunit/qunit-1.18.0.js"></script>

<script>

test ("make sure makeurl is working", function() {
	var word = "computer";
	var makeUrlTest = makeUrl(word);
	equal(makeUrlTest, 'http://api.wordnik.com/v4/word.json/' + word +
  "/definitions?limit=1&includeRelated=false&useCanonical=true&includeTags=false&api_key=a2a73e7b926c924fad7001ca3111acd55af2ffabf50eb4ae5");
});

test ('check we can return definition for a word and put it in HTML', function(assert) {
  var done = assert.async();
  ajaxGetRequest(makeUrl("sky"), displayResults);
  setTimeout(function() {
    var responseDivContent = document.getElementById("response").innerHTML;
    console.log(responseDivContent);
    equal(responseDivContent, "The expanse of air over any given point on the earth; the upper atmosphere as seen from the earth's surface.");
    done();
  }, 1000);
});

</script>

</body>
