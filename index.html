<html>
  <head>
    <link rel="stylesheet" href="https://code.jquery.com/qunit/qunit-1.18.0.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <!-- <link rel="stylesheet" href="main.css"> -->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Autocomplete Word Lookup like a Boss!</title>
  </head>
  <body>


    <style>

    strong {
      font-weight: bold;
      font-color: red;
    }
    </style>

    <div id="main-head">

      <div id='logo-border'>
        <div id="logo">
          <h1>UNSCRABBLE</h1>
        </div>
      </div>

      <div >
        <input type='text' id="input"> </input>
      </div>

      <div id="input-buttons">
        <button id="submit">Submit</button>
      </div>

      <div id="tweets"></div>

      <p id="response"></p>

    </div>


    <script>
    // twitter widjet js from twitter API dev website
        window.twttr = (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0],
          t = window.twttr || {};
        if (d.getElementById(id)) return t;
        js = d.createElement(s);
        js.id = id;
        js.src = "https://platform.twitter.com/widgets.js";
        fjs.parentNode.insertBefore(js, fjs);

        t._e = [];
        t.ready = function(f) {
          t._e.push(f);
        };

        return t;
      }(document, "script", "twitter-wjs"));

    </script>
    <script>
      function ajaxGetRequest (searchurl, callback){
        var request = new XMLHttpRequest();
        request.onreadystatechange = function() {
            if(request.readyState === 4) {
              callback(request.responseText);
            };
        };
        request.open("GET", searchurl, true);
        request.send();
      }
      function makeUrl (word) {
        return ('http://api.wordnik.com/v4/word.json/' + word +
        "/definitions?limit=1&includeRelated=false&useCanonical=true&includeTags=false&api_key=a2a73e7b926c924fad7001ca3111acd55af2ffabf50eb4ae5");
      }
      function displayResults (response) {
        var definition = JSON.parse(response)[0].text;
        document.getElementById("response").innerHTML = definition;
        console.log(definition);
        return definition;
      }

    </script>
      <div id="qunit"></div>
      <div id="qunit-fixture"></div>
      <script src="https://code.jquery.com/qunit/qunit-1.18.0.js"></script>

      <script>
      test ("check makeurl is working", function() {
      	var word = "computer";
      	var makeUrlTest = makeUrl(word);
      	equal(makeUrlTest, 'http://api.wordnik.com/v4/word.json/' + word +
        "/definitions?limit=1&includeRelated=false&useCanonical=true&includeTags=false&api_key=a2a73e7b926c924fad7001ca3111acd55af2ffabf50eb4ae5");
      });
      test ('check wordnik returns a definition and displays it in HTML', function(assert) {
        var done = assert.async();
        ajaxGetRequest(makeUrl("sky"), displayResults);
        setTimeout(function() {
          var responseDivContent = document.getElementById("response").innerHTML;
          console.log(responseDivContent);
          equal(responseDivContent, "The expanse of air over any given point on the earth; the upper atmosphere as seen from the earth's surface.");
          done();
        }, 1000);
      });
    </script>

    <script>
      $('#submit').on('click', (function(){
      var word = $('#input').val();
      ajaxGetRequest(makeUrl(word), displayResults);
        $.get('/twitter/'+word, function handler(tweetData) {
          // var repl = '<strong>' +word + '</strong>';
          // tweetData = tweetData.replace(word,repl);
          $('#tweets').html(tweetData);
        });
    })
  )

    </script>

  </body>
</html>
